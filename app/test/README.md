# Semi-automated testing of FC app

## Set up environment
Prerequisites: Docker and conda installed.
### Featurecloud CLI
```
mkdir fc-app-testing
cd fc-app-testing
git clone git@github.com:FeatureCloud/cli.git
cd cli
# requirements file is for pip
# remove '~' to fit conda
conda create --name cli --file requirements_conda.txt
cd ..
```

### Controller
For UNIX systems download controller and start controller
```
mkdir controller
cd controller
wget https://featurecloud.ai/assets/scripts/start_controller.sh
bash start_controller.sh
cd ..
```

### FC PCA code
Clone this repository
```
git clone git@github.com:AnneHartebrodt/fc-federated-pca.git
cd fc-federated-pca
#build docker image
docker build . --tag=federated_pca_batch
# add python path 
export $PYTHONPATH=$(pwd)/fc-federated-pca
cd ..
```

### Set up test environment with autogenerated toy data
```
bash fc-federated-pca/app/test/setup_test_environment.sh $(pwd)/controller/data/ $(pwd)/cli $(pwd)/fc-federated-pca/app/test
```
### Run the app
```
bash fc-federated-pca/app/test/test.sh $(pwd)/controller/data/ $(pwd)/cli $(pwd)/fc-federated-pca/app/test
```

### Generate the report
```
mkdit test-output
bash fc-federated-pca/app/test/generate_report.sh $(pwd)/controller/data/ $(pwd)/cli $(pwd)/fc-federated-pca/app/test $(pwd)/test-output
```
